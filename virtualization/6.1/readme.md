# DevOps Netology HW 6.1 "Типы и структура СУБД."

### Вопрос 1. 

*Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.*

*Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:*

- *Электронные чеки в json виде*
- *Склады и автомобильные дороги для логистической компании*
- *Генеалогические деревья*
- *Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации*
- *Отношения клиент-покупка для интернет-магазина*

*Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.*

#### Ответ:

* **Электронные чеки в json виде**  
Документоориентированные DB в частности MongoDB. 
  * Данная СУБД заточена под подобный вид данных.
  * Документы могут быть организованы в коллекции. Коллекции в свою очередь, могут содержать другие коллекции.
  * В отличие от хранилищ типа ключ-значение, выборка по запросу к документному хранилищу может содержать части большого количества документов без полной загрузки этих документов в оперативную память

* **Склады и автомобильные дороги для логистической компании**  
Если имеется в виду расчёт оптимальных маршрутов, то тогда следует использовать графовые БД, как раз заточенные под вычисления именно такого типа.

* **Генеалогические деревья**  
Тут соответственно, подходят иерархические базы данных. В такой БД мы получаем дерево со строгой иерархией. 

* **Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации**  
Здесь подходит Redis. Формат "ключ-значение", поддержка TTL, хранение данных в оперативной памяти (высокая скорость доступа к данным).

* **Отношения клиент-покупка для интернет-магазина**  
Очевидно что тут будет несколько связанных друг с другом таблиц. Здесь оптимально будет использовать MySQL/PostgreSQL.


### Вопрос 2. 

*Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):*

- *Данные записываются на все узлы с задержкой до часа (асинхронная запись)*
- *При сетевых сбоях, система может разделиться на 2 раздельных кластера*
- *Система может не прислать корректный ответ или сбросить соединение*

*А согласно PACELC-теореме, как бы вы классифицировали данные реализации?*

#### Ответ:

* Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- * <b> AP - так как Consistency отсутствует. </b>
- * <b> Это PA\EL-система. Корректный ответ будет получен в любом случае, но из-за задержки ответ от разных узлов может отличаться. </b>

* При сетевых сбоях, система может разделиться на 2 раздельных кластера
- * <b> AP. Сохраняется доступность и имеется устойчивость к разделению. </b>
- * <b> Это PA/EC-система. Каждый кластер будет доступен и будет отвечать на запросы. Но из-за разделения может произойти рассогласованность данных. </b>

* Система может не прислать корректный ответ или сбросить соединение
- * <b> Availability не выполнено, получается, CP. </b>
- * <b> PC/EC-система - здесь на первом плане консистентность. В жертву приносится доступность кластера. </b>

### Вопрос 3. 

*Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?*

#### Ответ:

*Если мыслить логически,то не могут.*

**BASE**: Главное - скорость ответа и доступность, достоверность полученных данных - не в приоритете.  

**ACID**: Главное - достоверность данных, скорость уходит на второй план.  

Соответственно, совместить два противоположных принципа в одной системе нереально.


### Вопрос 4. 

*Вам дали задачу написать системное решение, основой которого бы послужили:*

- *фиксация некоторых значений с временем жизни*
- *реакция на истечение таймаута*

*Вы слышали о key-value хранилище, которое имеет механизм Pub/Sub. Что это за система? Какие минусы выбора данной системы?*

#### Ответ:

**Выбор БД:**
*На вышеописанную задачу больше всего подойдёт Redis*  

**Минусы:**
* Все данные лежат в оперативке, следовательно, памяти надо много.*
* Требуется хорошее питание и надежный ИБП, если при скачке напряжения сервер перезагрузиться - данные утеряны.
* Нет гарантии, что подписчик гарантированно получит данные из БД. Если подписчик в текущий момент чем-то занят или не доступен, то, второй раз данные присылать не будет.
